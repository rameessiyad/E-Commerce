import{j as e,r as n,a as _,b as F,k as S,l as $,m as A,B as l}from"./index-_-uTey8g.js";const P="/assets/shoppage-Cp3lvUdb.jpeg",T=()=>e.jsxs("div",{className:"w-full h-[150px] md:h-[400px] sm:h-[300px] relative",children:[e.jsx("img",{src:P,alt:"banner",className:"w-full h-full object-cover"}),e.jsxs("div",{className:"flex flex-col p-4 gap-2 items-center bg-black bg-opacity-50 w-[40%] sm:w-[90%] md:w-[70%] h-[30%] sm:h-[40%] justify-center absolute top-0 bottom-0 left-0 right-0 m-auto",children:[e.jsx("h1",{className:"text-sm md:text-3xl sm:text-2xl text-white font-medium",children:"Shop Page"}),e.jsx("p",{className:"text-white text-center hidden md:block md:text-base sm:text-sm",children:"Let's design the place you always imagined"})]})]}),L=()=>{const g=["All","Clothing","Footwear","Accessories","Grooming"],[w,h]=n.useState([]),[j,u]=n.useState({}),[y,i]=n.useState({}),[x,b]=n.useState("All"),N=_(),p=async()=>{try{const t=await fetch(`${l}/product`);if(!t.ok)throw new Error("Failed to fetch products");const a=(await t.json())["All products"];h(a);const r=a.reduce((c,o)=>(c[o._id]=o.rating,c),{});u(r)}catch(t){console.log("Error fetching products",t)}},v=async t=>{try{const s=await fetch(`${l}/product/category/${t}`);if(!s.ok)throw new Error("Failed to fetch products by category");const r=await s.json();h(r);const c=r.reduce((o,d)=>(o[d._id]=d.rating,o),{});u(c)}catch(s){console.log("Error fetching products by category",s)}},E=async()=>{try{const t=await fetch(`${l}/cart`,{method:"GET",credentials:"include"});if(!t.ok)throw new Error("Failed to fetch cart");const a=(await t.json()).items.reduce((r,c)=>(r[c.product._id]=c.quantity,r),{});i(a)}catch(t){console.log("Error fetching cart",t)}};n.useEffect(()=>{p(),E()},[]),n.useEffect(()=>{x==="All"?p():v(x)},[x]);const f=async(t,s=1)=>{if(!localStorage.getItem("userInfo")){toast.warning("Login to add product to cart"),N("/login");return}try{const r=await fetch(`${l}/cart`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productId:t,quantity:s})});if(!r.ok)throw new Error("Failed to add product to cart");const c=await r.json();i(o=>({...o,[t]:(o[t]||0)+s}))}catch(r){console.log("Error adding product to cart",r)}},C=async t=>{try{const s=m(t);if(i(a=>({...a,[t]:s>1?s-1:0})),s>1){const a=await fetch(`${l}/cart`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productId:t,quantity:-1})});if(!a.ok)throw new Error("Failed to decrease product quantity");const c=(await a.json()).items.reduce((o,d)=>(o[d.product._id]=d.quantity,o),{});i(c)}else{if(!(await fetch(`${l}/cart/${t}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to remove product from cart");i(r=>{const{[t]:c,...o}=r;return o})}}catch(s){console.error("Error removing product from cart",s)}},m=t=>y[t]||0,k=t=>{b(t.target.value)};return e.jsxs("div",{children:[e.jsx(T,{}),e.jsx("div",{className:"py-10 flex items-start gap-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-gray-500 font-medium mb-1 uppercase",children:"Categories"}),e.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 bg-white",value:x,onChange:k,children:g.map((t,s)=>e.jsx("option",{value:t,children:t},s))})]})}),e.jsx("div",{className:"py-10 w-full flex flex-col items-center",children:e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4",children:w.map(t=>e.jsxs("div",{className:"bg-white shadow-sm rounded-lg w-[150px] sm:w-[45%] md:w-[300px] lg:w-[220px] flex-shrink-0 flex flex-col p-4",children:[e.jsxs("div",{className:"bg-gray-100 flex flex-col gap-2 p-3 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-1 self-start",children:[e.jsx("p",{className:"bg-white px-2 font-semibold text-xs sm:text-sm",children:"NEW"}),e.jsx("p",{className:"bg-green-400 px-2 text-white font-semibold text-xs sm:text-sm",children:"-50%"})]}),e.jsx(F,{to:`/product/${t._id}`,children:e.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-[100px] sm:h-[150px] object-cover rounded-md"})}),m(t._id)>0?e.jsxs("div",{className:"flex items-center justify-between mt-2 button",children:[e.jsx("button",{className:"text-xs sm:text-sm",onClick:()=>C(t._id),children:e.jsx(S,{})}),e.jsx("span",{className:"text-xs sm:text-sm mx-2",children:m(t._id)}),e.jsx("button",{className:"text-xs sm:text-sm",onClick:()=>f(t._id,1),children:e.jsx($,{})})]}):e.jsx("button",{className:"button text-xs sm:text-sm mt-2",onClick:()=>f(t._id,1),children:"Add to Cart"})]}),e.jsxs("div",{className:"flex flex-col p-4",children:[e.jsx("div",{className:"flex gap-1 mb-1",children:Array.from({length:5},(s,a)=>e.jsx(A,{color:a<j[t._id]?"#FFD700":"#E0E0E0",className:"cursor-pointer"},a))}),e.jsx("p",{className:"text-xs sm:text-base font-semibold",children:t.name}),e.jsxs("p",{className:"text-xs sm:text-sm font-semibold mt-1",children:["â‚¹ ",t.price]})]})]},t._id))})})]})};export{L as default};
