import{o as b,a as E,r as l,j as t,m as v,k,l as C,B as n,n as P}from"./index-DFFnt1R-.js";import{P as F}from"./ProductsSlider-OAEhh06-.js";const T=()=>{const{id:x}=b(),f=E(),[o,p]=l.useState({id:"",name:"",description:"",price:"",stock:"",category:"",colors:[],images:[]}),[g,j]=l.useState(0),[y,i]=l.useState({});l.useEffect(()=>{const e=async()=>{try{const a=await fetch(`${n}/product/${x}`);if(!a.ok)throw new Error("Product not found");const r=await a.json();p({id:r._id,name:r.name,description:r.description,price:r.price,stock:r.stock,category:r.category.name,colors:r.colors||[],images:r.images||[]})}catch(a){console.error("Error fetching product:",a)}},s=async()=>{try{const a=await fetch(`${n}/cart`,{method:"GEt",credentials:"include"});if(!a.ok)throw new Error("Failed to fetch cart");const m=(await a.json()).items.reduce((c,u)=>(c[u.product._id]=u.quantity,c),{});i(m)}catch(a){console.log("Error fetching cart",a)}};e(),s()},[x]);const w=(e,s)=>{j(a=>({...a,[e]:s}))},h=async(e,s)=>{if(!localStorage.getItem("userInfo")){P.warning("Login to add product to cart"),f("/login");return}try{const r=await fetch(`${n}/cart`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productId:e,quantity:1})});if(!r.ok)throw new Error("Failed to add product to cart");const m=await r.json();i(c=>({...c,[e]:(c[e]||0)+s}))}catch(r){console.log("Error adding product to cart",r)}},N=async e=>{try{const s=d(e);if(i(a=>({...a,[e]:s>1?s-1:0})),s>1){if(!(await fetch(`${n}/cart`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productId:e,quantity:-1})})).ok)throw new Error("Failed to remove product from cart")}else{if(!(await fetch(`${n}/cart/${e}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to remove product from cart");i(r=>{const{[e]:m,...c}=r;return c})}}catch(s){console.log("Error removing product from cart",s)}},d=e=>y[e]||0;return t.jsxs("div",{className:"flex flex-col items-center justify-between p-4",children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-center md:justify-between",children:[t.jsx("div",{className:"w-full grid grid-cols-2 gap-2",children:o.images.map((e,s)=>t.jsx("div",{className:"w-full",children:t.jsx("div",{className:"bg-gray-100 p-1",children:t.jsx("img",{src:e,alt:"product",className:"object-contain w-full h-[200px]"})})},s))}),t.jsxs("div",{className:"flex flex-col gap-4 md:ml-8 mt-4 md:mt-0",children:[t.jsx("div",{className:"flex gap-1 mb-4",children:Array.from({length:5},(e,s)=>t.jsx(v,{color:s<g[o.id]?"#FFD700":"#E0E0E0",className:"cursor-pointer",onClick:()=>w(o.id,s+1)},s))}),t.jsx("h1",{className:"text-4xl font-bold mb-2",children:o.name}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:o.description}),t.jsxs("p",{className:"text-sm text-gray-500 mb-4 mt-2",children:[t.jsx("span",{className:"text-gray-700",children:"Category:"})," ",o.category]}),t.jsxs("p",{className:"text-2xl font-semibold mb-4",children:["â‚¹ ",o.price]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"text-sm mb-3",children:"Available colors:"}),t.jsx("ul",{children:o.colors.map((e,s)=>t.jsxs("li",{className:"text-sm text-gray-500 mb-2",children:[t.jsx("span",{className:"text-gray-700"})," ",e]},s))})]}),d(o.id)>0?t.jsxs("div",{className:"flex items-center justify-between mt-2 button",children:[t.jsx("button",{className:"text-xs sm:text-sm",onClick:()=>N(o.id),children:t.jsx(k,{})}),t.jsx("span",{className:"text-xs sm:text-sm mx-2",children:d(o.id)}),t.jsx("button",{className:"text-xs sm:text-sm",onClick:()=>h(o.id,1),children:t.jsx(C,{})})]}):t.jsx("button",{className:"button",onClick:()=>h(o.id,1),children:"Add to Cart"})]})]}),t.jsxs("div",{className:"mt-10 py-10 w-full flex flex-col gap-8",children:[t.jsx("h1",{className:"text-3xl font-medium",children:"You might also like"}),t.jsx(F,{})]})]})};export{T as default};
