import{j as t,r as n,a as _,b as F,k as S,l as $,m as A,B as l,n as P}from"./index-DFFnt1R-.js";const T="/assets/shoppage-Cp3lvUdb.jpeg",R=()=>t.jsxs("div",{className:"w-full h-[150px] md:h-[400px] sm:h-[300px] relative",children:[t.jsx("img",{src:T,alt:"banner",className:"w-full h-full object-cover"}),t.jsxs("div",{className:"flex flex-col p-4 gap-2 items-center bg-black bg-opacity-50 w-[40%] sm:w-[90%] md:w-[70%] h-[30%] sm:h-[40%] justify-center absolute top-0 bottom-0 left-0 right-0 m-auto",children:[t.jsx("h1",{className:"text-sm md:text-3xl sm:text-2xl text-white font-medium",children:"Shop Page"}),t.jsx("p",{className:"text-white text-center hidden md:block md:text-base sm:text-sm",children:"Let's design the place you always imagined"})]})]}),L=()=>{const g=["All","Clothing","Footwear","Accessories","Grooming"],[w,h]=n.useState([]),[j,u]=n.useState({}),[y,i]=n.useState({}),[x,b]=n.useState("All"),N=_(),p=async()=>{try{const e=await fetch(`${l}/product`);if(!e.ok)throw new Error("Failed to fetch products");const a=(await e.json())["All products"];h(a);const r=a.reduce((o,c)=>(o[c._id]=c.rating,o),{});u(r)}catch(e){console.log("Error fetching products",e)}},v=async e=>{try{const s=await fetch(`${l}/product/category/${e}`);if(!s.ok)throw new Error("Failed to fetch products by category");const r=await s.json();h(r);const o=r.reduce((c,d)=>(c[d._id]=d.rating,c),{});u(o)}catch(s){console.log("Error fetching products by category",s)}},E=async()=>{try{const e=await fetch(`${l}/cart`,{method:"GET",credentials:"include"});if(!e.ok)throw new Error("Failed to fetch cart");const a=(await e.json()).items.reduce((r,o)=>(r[o.product._id]=o.quantity,r),{});i(a)}catch(e){console.log("Error fetching cart",e)}};n.useEffect(()=>{p(),E()},[]),n.useEffect(()=>{x==="All"?p():v(x)},[x]);const f=async(e,s=1)=>{if(!localStorage.getItem("userInfo")){P.warning("Login to add product to cart"),N("/login");return}try{if(!(await fetch(`${l}/cart`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productId:e,quantity:s})})).ok)throw new Error("Failed to add product to cart");i(o=>({...o,[e]:(o[e]||0)+s}))}catch(r){console.log("Error adding product to cart",r)}},C=async e=>{try{const s=m(e);if(i(a=>({...a,[e]:s>1?s-1:0})),s>1){const a=await fetch(`${l}/cart`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productId:e,quantity:-1})});if(!a.ok)throw new Error("Failed to decrease product quantity");const o=(await a.json()).items.reduce((c,d)=>(c[d.product._id]=d.quantity,c),{});i(o)}else{if(!(await fetch(`${l}/cart/${e}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("Failed to remove product from cart");i(r=>{const{[e]:o,...c}=r;return c})}}catch(s){console.error("Error removing product from cart",s)}},m=e=>y[e]||0,k=e=>{b(e.target.value)};return t.jsxs("div",{children:[t.jsx(R,{}),t.jsx("div",{className:"py-10 flex items-start gap-3",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"text-gray-500 font-medium mb-1 uppercase",children:"Categories"}),t.jsx("select",{className:"border border-gray-300 rounded px-3 py-2 bg-white",value:x,onChange:k,children:g.map((e,s)=>t.jsx("option",{value:e,children:e},s))})]})}),t.jsx("div",{className:"py-10 w-full flex flex-col items-center",children:t.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4",children:w.map(e=>t.jsxs("div",{className:"bg-white shadow-sm rounded-lg w-[150px] sm:w-[45%] md:w-[300px] lg:w-[220px] flex-shrink-0 flex flex-col p-4",children:[t.jsxs("div",{className:"bg-gray-100 flex flex-col gap-2 p-3 w-full",children:[t.jsxs("div",{className:"flex flex-col gap-1 self-start",children:[t.jsx("p",{className:"bg-white px-2 font-semibold text-xs sm:text-sm",children:"NEW"}),t.jsx("p",{className:"bg-green-400 px-2 text-white font-semibold text-xs sm:text-sm",children:"-50%"})]}),t.jsx(F,{to:`/product/${e._id}`,children:t.jsx("img",{src:e.images[0],alt:e.name,className:"w-full h-[100px] sm:h-[150px] object-cover rounded-md"})}),m(e._id)>0?t.jsxs("div",{className:"flex items-center justify-between mt-2 button",children:[t.jsx("button",{className:"text-xs sm:text-sm",onClick:()=>C(e._id),children:t.jsx(S,{})}),t.jsx("span",{className:"text-xs sm:text-sm mx-2",children:m(e._id)}),t.jsx("button",{className:"text-xs sm:text-sm",onClick:()=>f(e._id,1),children:t.jsx($,{})})]}):t.jsx("button",{className:"button text-xs sm:text-sm mt-2",onClick:()=>f(e._id,1),children:"Add to Cart"})]}),t.jsxs("div",{className:"flex flex-col p-4",children:[t.jsx("div",{className:"flex gap-1 mb-1",children:Array.from({length:5},(s,a)=>t.jsx(A,{color:a<j[e._id]?"#FFD700":"#E0E0E0",className:"cursor-pointer"},a))}),t.jsx("p",{className:"text-xs sm:text-base font-semibold",children:e.name}),t.jsxs("p",{className:"text-xs sm:text-sm font-semibold mt-1",children:["â‚¹ ",e.price]})]})]},e._id))})})]})};export{L as default};
