import{r as c,a as S,j as e,B as u,q as f}from"./index-DFFnt1R-.js";import{S as x}from"./Steps-_BDDEEyq.js";const T=()=>{const[d,p]=c.useState(1),[N,g]=c.useState([]),[b,j]=c.useState(0),[a,h]=c.useState({firstName:"",lastName:"",phoneNumber:"",email:"",shippingAddress:{streetAddress:"",town:"",state:"",pinCode:""}}),[A,m]=c.useState(!1),y=S(),v=async()=>{try{const s=await fetch(`${u}/cart/`,{method:"GET",credentials:"include"});if(!s.ok)throw new Error("Failed to fetch cart products");const r=(await s.json()).items.map(t=>({id:t.product._id,title:t.product.name,price:t.product.price,image:t.product.images[0],quantity:t.quantity,color:t.color,subtotal:t.product.price*t.quantity}));g(r);const o=r.reduce((t,C)=>t+C.subtotal,0);j(o)}catch(s){console.log("Error fetching cart products:",s)}};c.useEffect(()=>{v()},[]);const i=s=>{const{name:l,value:r}=s.target;h(o=>({...o,[l]:r})),p(2)};console.log(a);const n=s=>{const{name:l,value:r}=s.target;h(o=>({...o,shippingAddress:{...o.shippingAddress,[l]:r}}))},w=async s=>{s.preventDefault();try{m(!0);const l=await fetch(`${u}/order`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({shippingAddress:a.shippingAddress})});if(!l.ok)throw m(!1),f.error("Failed to create order"),new Error("Failed to create order");const r=await l.json();m(!1),f.success("Order created successfully"),p(3),y("/order-complete")}catch{}};return e.jsxs("div",{className:"mt-10 px-4 flex flex-col gap-5",children:[e.jsx("h1",{className:"text-4xl sm:text-5xl text-center font-medium mb-10",children:"Check Out"}),e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsx(x,{stepNumber:1,label:"Shopping Cart",isActive:d===1,isCompleted:d>1}),e.jsx("div",{className:"h-1 w-8 sm:w-16 bg-gray-300"}),e.jsx(x,{stepNumber:2,label:"Checkout Details",isActive:d===2,isCompleted:d>2}),e.jsx("div",{className:"h-1 w-8 sm:w-16 bg-gray-300"}),e.jsx(x,{stepNumber:3,label:"Order Complete",isActive:d===3,isCompleted:d>3})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("form",{className:"flex flex-col py-10 gap-8",onSubmit:w,children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-primary shadow-lg",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"Contact Information"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("label",{htmlFor:"firstName",className:"mb-3 text-xs",children:"FIRST NAME"}),e.jsx("input",{type:"text",name:"firstName",placeholder:"First Name",value:a.firstName,onChange:i,className:"border border-gray-300 rounded px-3 py-2 w-full",required:!0})]}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("label",{htmlFor:"lastName",className:"mb-3 text-xs",children:"LAST NAME"}),e.jsx("input",{type:"text",name:"lastName",placeholder:"Last Name",value:a.lastName,onChange:i,className:"border border-gray-300 rounded px-3 py-2 w-full",required:!0})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"phoneNumber",className:"mb-3 text-xs",children:"PHONE NUMBER"}),e.jsx("input",{type:"text",name:"phoneNumber",placeholder:"Phone Number",value:a.phoneNumber,onChange:i,className:"border border-gray-300 rounded px-3 py-2",required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"email",className:"mb-3 text-xs",children:"EMAIL ADDRESS"}),e.jsx("input",{type:"email",name:"email",placeholder:"Email Address",value:a.email,onChange:i,className:"border border-gray-300 rounded px-3 py-2",required:!0})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-primary shadow-lg",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"Shipping Address"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"streetAddress",className:"mb-3 text-xs",children:"STREET ADDRESS"}),e.jsx("input",{type:"text",name:"streetAddress",placeholder:"Street Address",value:a.shippingAddress.streetAddress,onChange:n,className:"border border-gray-300 rounded px-3 py-2 w-full",required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"town",className:"mb-3 text-xs",children:"TOWN"}),e.jsx("input",{type:"text",name:"town",placeholder:"Town",value:a.shippingAddress.town,onChange:n,className:"border border-gray-300 rounded px-3 py-2 w-full",required:!0})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("label",{htmlFor:"state",className:"mb-3 text-xs",children:"STATE"}),e.jsx("input",{type:"text",name:"state",placeholder:"State",value:a.shippingAddress.state,onChange:n,className:"border border-gray-300 rounded px-3 py-2 w-full",required:!0})]}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("label",{htmlFor:"pinCode",className:"mb-3 text-xs",children:"PIN CODE"}),e.jsx("input",{type:"text",name:"pinCode",placeholder:"Pin Code",value:a.shippingAddress.pinCode,onChange:n,className:"border border-gray-300 rounded px-3 py-2 w-full",required:!0})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-primary shadow-lg",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"Payment Method"}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("p",{className:"font-medium text-xl",children:"Cash on Delivery"})})]}),e.jsx("button",{type:"submit",className:"w-full py-3 px-6 bg-primary text-white rounded hover:bg-primary-dark",children:"Place Order"})]})}),e.jsxs("div",{className:"w-full md:w-80  bg-white p-6 rounded-lg shadow-lg max-h-svh overflow-auto pb-10",children:[e.jsx("h2",{className:"text-lg font-medium mb-4",children:"Cart Summary"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[N.map(s=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:s.image,alt:s.title,className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",s.quantity]}),e.jsxs("p",{className:"text-sm font-medium",children:["Subtotal: $",s.subtotal.toFixed(2)]})]})]},s.id)),e.jsxs("div",{className:"flex justify-between font-medium mt-4",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",b.toFixed(2)]})]})]})]})]})]})};export{T as default};
